# ACID(트랜잭션 처리원칙)

---

## 1. 트랜잭션 ACID란?

### 개념

- 트랜잭션이 어떤 속성을 지녀야 하는지 나타내는 핵심이다. 
- 트랜잭션은 ACID 규칙을 모두 보장해야 데이터베이스 트랜잭션이 안전하게 수행된다.
- ACID는 원자성(Atomicity), 일관성(Consistency), 격리성(Isolation), 지속성(Durability)의 앞글자를 딴 규칙이다.

### 원자성(Atomicity)

- ALL OR NOTHING 
- 트랜잭션은 모두 실행하거나 모두 실행하지 않음의 두 가지 상태만 존재한다.
- 트랜잭션은 논리적으로 쪼개질 수 없는 작업 단위이기 때문에, 내부 SQL 문들이 모두 성공하거나, 중간에 하나라도 실패하면 그 전까지의 작업을 모두 취소하여 이전 상태로 롤백해야 한다.
  - 즉, 일부만 성공하는 상태는 존재할 수 없다.  
- 성공 시 커밋하면 DB에 영구적으로 저장되고, 실패 시 롤백하여 이전 상태로 되돌린다. 이 부분은 DBMS가 담당한다.
- 개발자는 언제 커밋하고 언제 롤백할지에 대한 기준을 세워야 한다.

### 일관성(Consistency)

- 트랜잭션 이전과 이후에 데이터베이스는 항상 consistent한 상태여야 한다는 규칙이다.
- 트랜잭션은 DB 상태를 consistent 상태에서 또 다른 consistent 상태로 이동해야 한다.
- 만약 트랜잭션이 DB에 정의된 규칙을 위반했다면 롤백해야 한다.
  - 예를 들어, 계좌의 잔액을 업데이트하는 트랜잭션에서 잔액이 마이너스로 바뀌는 경우, 그 트랜잭션은 롤백된다.  
- DBMS는 트랜잭션이 DB 규칙을 위반했는지 커밋 전에 확인하고 알려준다.
- 개발자도 애플리케이션 관점에서 트랜잭션이 consistent하게 동작하는지 확인해야 한다.

### 고립성(Isolation)

- 여러 트랜잭션이 동시에 실행될 때, 각 트랜잭션은 마치 독립적으로 실행되는 것처럼 동작해야 한다.
  - 즉, 동시에 실행되는 여러 트랜잭션은 서로 영향을 주지 않도록 격리되어야 한다.  
- DBMS는 여러 종류의 isolation level을 제공하며, 개발자는 적절한 isolation level을 선택해 트랜잭션을 동작시킬 수 있다.  
- 이 목표는 concurrency control에 있다.
  - 여러 트랜잭션이 동시에 실행되었을 때 결과가 이상해지는 문제를 방지한다.

### 지속성(Durability)

- 커밋된 트랜잭션의 결과는 데이터베이스에 영구적으로 저장되어야 한다.
- '영구적 저장' == '비휘발성 메모리(HDD, SSD 등)에 저장'
- DB 시스템에 전원이 꺼지거나 시스템 오류가 발생해도 커밋된 결과는 여전히 데이터베이스에 남아 있어야 한다.
- 이 부분은 DBMS가 보장하며, 개발자가 별도로 할 수 있는 일은 없다.

---

### 참고자료

[트랜젝션 ACID](https://engineerinsight.tistory.com/210)