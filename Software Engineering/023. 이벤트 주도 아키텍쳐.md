# 이벤트 주도 아키텍쳐

---

## 1. 이벤트 주도 아키텍처(EDA)란?

- 이벤트 주도 아키텍처(Event-Driven Architecture, EDA)는 비동기 이벤트를 중심으로 구성된 아키텍처 
- 마이크로서비스 간 느슨한 결합과 비동기 통신을 가능하게 하여 확장성과 유연성을 확보한디
- 이벤트를 기반으로 흐름을 제어하고, 이벤트 메시지를 통해 생산자와 소비자를 시간/공간적으로 분리한다.

---

## 2. 이벤트 아키텍처 구성 방식

### 중재자 토폴로지 (Mediator Topology)

- 중앙의 이벤트 중재자가 이벤트 흐름을 제어.
- 여러 이벤트를 순차적으로 연결하고 오케스트레이션이 필요한 경우 적합.
- 구현 도구: `Spring Integration`, `Apache Camel` 등

### 브로커 토폴로지 (Broker Topology)

- 중앙 제어 없이 각 컴포넌트가 메시지 브로커(Kafka, RabbitMQ 등)를 통해 이벤트를 주고받음.
- 단순하고 독립적인 이벤트 처리를 원할 때 유용.

---

## 3. 이벤트 소싱 (Event Sourcing)

- 이벤트 소싱은 상태 변경의 결과가 아닌, 상태 변경을 유발한 이벤트 자체를 저장하는 방식입니다.
- 장애 발생 시 이벤트를 재생하여 상태 복원 가능.

### 이벤트 저장소란?

- 이벤트 저장소는 시스템 내에서 발생한 모든 도메인 이벤트를 시간 순서대로 안전하게 저장하고, 
- 필요 시 재구성할 수 있도록 지원하는 핵심 인프라입니다.

### 이벤트 저장소의 조건

- 이벤트는 추가만 가능 (삭제/수정 불가)
- 이벤트는 트랜잭션 단위로 커밋/롤백
- 이벤트 유실 없이 보존
- 애그리거트별 이벤트 조회 가능
- 이벤트는 삽입 순서대로 읽기 가능
- 대표 구현체: Event Store, Axon Framework, Eventuate 등
- 실무 사례: 배달의민족 - RDB 기반 이벤트 저장소 구현

---

### 4. 이벤트 저장소의 부하 해결법

- 스냅샷(Snapshot)
  - 애그리거트의 현재 상태를 정기적으로 저장하여, 전체 이벤트를 모두 리플레이하지 않고도 빠르게 복원 가능
- CQRS 패턴   
  - Command(Create/Update/Delete)와 Query(Read)를 분리
  - CUD는 이벤트 저장소, Read는 별도 읽기 전용 DB에 반영하여 읽기 부하 분산

---

### 참고자료

[이벤트 주도 아키텍쳐](https://velog.io/@suhongkim98/MSA%EC%99%80-DDD-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EC%A3%BC%EB%8F%84-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-5)