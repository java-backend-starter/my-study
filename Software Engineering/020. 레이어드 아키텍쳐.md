# 레이어드 아키텍처

---

## 1. 레이어드 아키텍처란?

- 레이어드 아키텍처는 각 계층이 어플리케이션 내에서 특정 역할과 책임을 가지며, 구성 요소 간 관심사를 분리하여 추상화된 인터페이스로만 상호 작용한다.
- 일반적으로 3개의 계층(Presentation, Business, Persistence)으로 구성되며, 실제 데이터는 외부의 DBMS(Database Management System)에 저장된다.

---

## 2. 계층별 특징

### Presentation Layer

- 사용자 혹은 클라이언트 시스템과 직접 연결됨
- 사용자 인터페이스 및 입력 검증 처리
- 비즈니스 로직에는 관여하지 않음

### Business Layer

- 시스템의 핵심 비즈니스 로직 구현
- Presentation Layer에서 받은 요청을 처리
- 도메인 모델 및 규칙을 중심으로 설계됨

### Persistence Layer

- 데이터의 영구 저장 및 관리
- 데이터베이스와의 상호작용 추상화 (예: Repository 패턴)
- 비즈니스 로직이 데이터 접근 방식에 의존하지 않도록 분리

### Database (외부 인프라)

- 실제 데이터베이스 (DBMS)
- Persistence Layer에서 추상화된 인터페이스를 통해 접근

---

## 3. 핵심 개념

### 관심사 분리 (Separation of Concerns)

- 각 계층은 자신의 역할에만 집중
- 비즈니스 로직은 UI 처리나 DB 접근에 관여하지 않음
- 유연성과 유지보수성 향상

### 단방향 의존성 (Unidirectional Dependency)

- 상위 계층만 하위 계층을 호출 가능
- 하위 계층은 상위 계층을 몰라야 함 (인터페이스만 제공)

### 계층 격리 (Layer Isolation)

#### Closed Layer

- 요청은 반드시 인접한 계층을 통해 흐름
- 예: Presentation → Business → Persistence → Database

#### Open Layer

- 특정 요청에 대해 계층을 건너뛰어도 허용
- 예: 이미지 처리 계층을 Business와 Persistence 사이에 삽입

---

## 4. 설계 원칙

### DIP (Dependency Inversion Principle)

- 상위 계층이 하위 계층의 구현이 아닌 인터페이스에 의존
- 인터페이스를 통해 느슨한 결합 유지

### OCP (Open/Closed Principle)

- 시스템은 확장에는 열려 있으나 수정에는 닫혀야 함
- 레이어드 아키텍처는 DIP는 잘 만족하지만,
    - 비즈니스 로직이 바뀌면 Presentation이나 Persistence 계층도 수정이 필요할 수 있어 OCP 위반 가능

---

## 5. 아키텍처 싱크홀 안티패턴

- 상위 레이어에서 하위 레이어로 요청이 이동할 때 중간 레이어에서 아무 처리도 하지 않고 전달만 하는 현상
- 불필요한 함수 호출과 리소스 낭비 유발
- 전체 요청의 약 20% 정도는 허용되나, 더 많아지면 구조 변경 고려
- 해결 방법: 중간 계층 제거 또는 역할 재정의

---

## 6. 토폴로지 구성

- 모든 레이어를 한 묶음으로 구성할 필요는 없음
- 예: Presentation과 Business는 함께, DB는 따로 배포
- 중요 기준은 "역할과 책임"에 따른 구분과 인터페이스 추상화

---

## 7. 장점과 단점

### 장점

- 관심사 분리에 따른 코드 재사용성 및 유지보수성 향상
- 각 계층 독립 개발/확장/변경 가능 → 유연성 확보
- 독립 테스트 가능 → 테스트 용이

### 단점

- 계층 간 통신으로 인한 오버헤드
- 대규모 프로젝트에서는 복잡도 증가
- 구조에 따라 민첩성이 떨어질 수 있음
- 잘못 사용하면 OCP나 싱크홀 문제 발생 가능

---

## 8. 언제 사용하는가?

- 중소 규모의 앱, 웹 애플리케이션에 적합
- 아키텍처 설계의 출발점으로 좋은 선택
- 너무 단순한 시스템에는 오버엔지니어링이 될 수 있고,  
  너무 복잡한 시스템에는 헥사고날, 클린 아키텍처 등 다른 패턴이 더 적합할 수 있음

---

### 참고자료

[레이어드 아키텍처](https://velog.io/@yisuho/%EB%A0%88%EC%9D%B4%EC%96%B4%EB%93%9C-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98Layered-Architecture#%EB%A0%88%EC%9D%B4%EC%96%B4%EB%93%9C-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98layered-architecture)