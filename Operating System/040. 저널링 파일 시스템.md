# 저널링 파일 시스템

---

## 1. 저널링 파일 시스템이란?

- 저널링 파일 시스템은 파일 시스템의 변경 사항을 기록하여 시스템 장애 발생 시 빠른 복구를 가능하게 하는 파일 시스템이다. 
- 변경 이력을 저장함으로써 fsck와 같은 파일 시스템 검사 도구를 사용할 때 복구 시간을 단축할 수 있다.

---

## 2. 저널링(Journaling)의 개념

- 정의: 데이터를 실제 저장소에 기록하기 전에 저널(Journal) 영역에 변경 이력을 먼저 기록하는 방식이다. 
- 목적: 시스템 장애 발생 시 빠르고 안정적인 복구를 위한 것이다. 
- 구성: 파일 시스템은 메타데이터 블록과 데이터 블록으로 나뉘며, 저널링은 이들 블록의 변경 사항을 기록한다.

---

## 3. 동작 방식

- 사용자가 파일을 수정하면, 변경 내용을 즉시 저장하는 대신 해당 변경 이력을 저널에 기록한다. 
- 시스템이 비정상적으로 종료되더라도 저널을 통해 변경 사항을 추적하여 복구할 수 있다.

### 장점

- 시스템 장애 발생 시 빠른 복구가 가능하다. 
- 파일 시스템의 무결성을 유지할 수 있다.

### 단점

- 시스템 호출 수준에서만 일관성을 유지하므로, write() 함수를 여러 번 호출하는 작업 중간에 장애가 발생하면 데이터 손실이 발생할 수 있다. 
- 저널링으로 인해 추가적인 디스크 I/O가 발생하여 성능 저하가 있을 수 있다.

--- 

## 4. 주요 저널링 파일 시스템 종류

- RFS (Reiser File System): 한스 라이저가 개발 
- XFS (eXtended File System): SGI에서 개발 
- JFS (Journaling File System): IBM에서 개발 
- ext3/ext4: 리눅스 커뮤니티에서 개발

---

## 5. ext4의 저널링 모드

### Journal Mode

- 메타데이터와 데이터 변경 사항 모두를 저널에 기록한다. 
- 가장 높은 데이터 일관성을 제공하지만, 디스크 I/O가 많아 성능이 저하될 수 있다.

### Ordered Mode (기본값)

- 메타데이터 변경 사항만 저널에 기록하고, 데이터는 먼저 기록한 후 메타데이터를 기록한다.
- 성능과 데이터 일관성 간의 균형을 제공한다.

### Write-back Mode

- 메타데이터 변경 사항만 저널에 기록하며, 데이터와 메타데이터의 기록 순서가 보장되지 않는다. 
- 가장 빠른 성능을 제공하지만, 데이터 손실 위험이 높다.

---

### 참고자료

[저널링 파일 시스템](https://hoho325.tistory.com/435)