# 프로세스간 통신

---

## 0. 개요

- IPC는 서로 독립적인 프로세스들이 데이터를 주고받거나 상태를 동기화하기 위한 메커니즘
- 다음은 대표적인 IPC 방식들입니다.

--- 

## 1. 파이프(Pipe)

### 개념

- 한쪽 프로세스가 데이터를 쓰면, 다른 한쪽이 이를 읽는 방식
- 일반적으로 부모-자식 관계에서 사용됨

### 특징

- 익명 파이프 (Unnamed Pipe): pipe() 시스템 콜로 생성, 부모-자식 간에만 사용 가능
- 이름 있는 파이프 (Named Pipe, FIFO): mkfifo()를 통해 생성, 서로 무관한 프로세스 간 통신 가능

### 장점

- 구현이 간단
- 커널 버퍼를 통해 데이터 전달

### 단점

- 속도가 느림 (커널을 경유함)
- 동기화가 어려움
- 익명 파이프는 양방향 통신이 불가

예시:
```c
int fd[2];
pipe(fd);
write(fd[1], "Hello", 5);
read(fd[0], buf, 5);
```
---

## 2. 메시지 큐(Message Queue)

### 개념

- 커널이 관리하는 메시지 저장소를 통해 프로세스 간 메시지를 교환
- 메시지는 타입과 데이터로 구성됨

### 특징

- 여러 프로세스가 큐에 접근 가능
- 구조화된 메시지 사용
- 메시지의 우선순위 지정 가능

### 장점

- 프로세스 간 독립성 유지
- 데이터 손실이 적음
- 동기화 없이 메시지 기반 통신 가능

### 단점

- 구현 복잡도 있음
- 메시지 크기 제한 있음

### 예시

- msgget(), msgsnd(), msgrcv() 함수 사용

---

## 3. 공유 메모리(Shared Memory)

### 개념

- 여러 프로세스가 하나의 메모리 공간을 공유하여 데이터를 직접 읽고 씀

### 특징

- 메모리 매핑 (mmap), shmget, shmat 등으로 사용
- 가장 빠른 IPC 방식

### 장점

- 속도 매우 빠름 (커널 개입 최소)
- 대용량 데이터 교환에 적합

### 단점

- 동기화 필요 (세마포어, 뮤텍스 등)
- 메모리 접근 오류 위험 있음

### 예시

```
key_t key = ftok("shmfile", 65);
int shmid = shmget(key, 1024, 0666|IPC_CREAT);
char *str = (char*) shmat(shmid, NULL, 0);
```

---

## 4. 소켓(Socket)

### 개념

- 네트워크 기반 통신 방식
- 같은 시스템 내 또는 다른 시스템 간 통신 가능

### 특징

- TCP (연결지향) / UDP (비연결지향) 지원
- socket(), bind(), listen(), connect() 등 사용

### 장점

- 범용성 높음 (로컬 및 원격 통신 모두 가능)
- 다양한 플랫폼/언어에서 사용 가능

### 단점

- 오버헤드가 큼 (프로토콜 처리)
- 속도 느림 (네트워크 스택 경유)

### 예시

- 클라이언트/서버 통신 (HTTP, FTP 등)
- 로컬 IPC (UNIX 도메인 소켓)

---

## 5. 세마포어(Semaphore)

### 개념

- 공유 자원에 대한 동시 접근 제어를 위한 동기화 도구
- 데이터 전달보다는 상태나 동작 제어에 사용

### 특징

- Binary (0 또는 1) 또는 Counting (0 이상) 형태
- semget(), semop() 등으로 사용

### 장점

- 동기화 용이 (공유 메모리와 자주 함께 사용)
- 경쟁 조건(Race Condition) 예방

### 단점

- 설계가 복잡할 수 있음
- 데드락(deadlock) 위험

### 예시

- 생산자-소비자 문제
- 임계 구역 보호

--- 

## 6. IPC 방식 비교 요약표

| 방식           | 통신 속도 | 관계 요구 | 동기화 필요 | 특징 |
|----------------|------------|-------------|----------------|--------|
| 파이프         | 느림       | 부모-자식   | 필요 없음 (기본) | 단방향, 간단 |
| 이름 있는 파이프 | 느림     | 무관        | 필요 없음      | 파일 기반, 양방향 가능 |
| 메시지 큐       | 중간       | 무관        | 없음            | 커널 버퍼 사용 |
| 공유 메모리     | 빠름       | 무관        | 필요            | 대용량 데이터 교환에 적합 |
| 소켓           | 느림       | 무관 (원격도 가능) | 없음 | 범용적, 네트워크 기반 |
| 세마포어        | 없음(통신용 아님) | 무관 | 동기화 용도 | 공유 자원 보호 |

---

### 참고자료

[프로세스간 통신](https://velog.io/@threeone/%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EA%B0%84-%ED%86%B5%EC%8B%A0-%EB%B0%A9%EB%B2%95Inter-Process-Communication-IPC)