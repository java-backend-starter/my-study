# 인터럽트

---

## 1. 인터럽트

### 폴링(Polling) 방식

- 초기 컴퓨터 시스템에서는 CPU가 직접 입출력장치 상태를 주기적으로 점검하고 데이터를 처리하는 방식 
- 요리사 비유: 요리사가 재료가 필요할 때마다 직접 창고에 가서 가져오는 방식. 
- 문제점: CPU가 명령어 처리 외에도 입출력까지 전담해야 하므로 작업 효율이 크게 떨어짐.

### 인터럽트(Interrupt) 방식

- 입출력 제어기와 DMA 제어기는 작업이 완료되면 CPU에 인터럽트를 보낸다.
- 인터럽트는 주변장치의 입출력 요청이나 하드웨어 이상을 CPU에 알려주는 신호이다.
- 등장 이유: 주변장치 증가로 CPU가 모든 입출력을 직접 관리하는 것은 비효율적이기 때문이다. 
- 요리사 비유: 주방 보조를 두고, 필요한 재료를 주방 보조가 가져다주며, 완료되었음을 요리사에게 알리는 방식. 
- 효과: CPU는 입출력 작업을 지시한 후 다른 일을 할 수 있으며, 입출력 완료 시 신호를 받아 필요한 처리를 수행한다.
- 인터럽트가 발생하는 상황은 다음과 같다.
  - CPU가 요청한 작업을 완료했을 때
  - 키보드로 데이터를 입력받았을 때
  - 네트워크 카드에 새로운 데이터가 도착했을 때
  - 하드웨어에 이상이 발생했을 때

### 인터럽트 방식 동작 과정

- CPU가 입출력 관리자에게 입출력 명령 전달. 
- 입출력 관리자는 데이터 이동(메모리 ↔ 저장장치)을 수행. 
- 작업 완료 후 입출력 관리자가 CPU에 완료 신호(인터럽트) 전달. 
- CPU는 하던 작업을 중단하고 인터럽트를 처리.

### 인터럽트의 종류

#### 외부 인터럽트 (하드웨어 인터럽트)

- 입출력 장치나 전원 이상, 기계적 오류 등 하드웨어 요인으로 발생한다. 
- 각 장치에는 고유한 IRQ(Interrupt Request) 번호가 부여된다. 
- 예시: IRQ 1번(키보드), IRQ 10번(네트워크), IRQ 12번(마우스)

#### 내부 인터럽트 (예외 상황 인터럽트)

- 프로세스 오류로 인해 발생한다. (예: 숫자를 0으로 나누기, 주소 공간 초과 접근 등)
- 내부 인터럽트가 발생하면 해당 프로세스는 즉시 종료된다. 
- 운영체제는 프로세스가 종료되기 직전 메모리와 레지스터 상태를 저장하는데, 이를 **코어 덤프(Core Dump)**라고 한다.

#### 자발적 인터럽트 (시그널, Signal)

- 사용자가 의도적으로 발생시키는 인터럽트이다.
- 예시
  - Ctrl + C: 프로세스 종료 요청 (SIGINT, 시그널 2번)
  - Ctrl + Z: 프로세스 일시 중지 (SIGSTOP, 시그널 24번)

### 인터럽트 번호와 IRQ 번호

- 내부 인터럽트 번호는 0번부터 31번까지 할당되어 있다. (현재 0~19번만 정의되어 있다)
- 외부 인터럽트 번호는 IRQ 번호와 매칭된다. 
  - 예시: IRQ 0번은 인터럽트 번호 32번, IRQ 15번은 인터럽트 번호 47번이다. 
- 시그널은 인터럽트 번호 128번을 사용하고, 세부 시그널 번호를 따로 명시한다. 
- IRQ 번호와 인터럽트 번호는 서로 다른 개념이므로 혼동하지 않아야 한다.

---

## 2. 인터럽트 벡터와 인터럽트 핸들러

### 인터럽트 벡터

- 여러 인터럽트 중에서 어떤 인터럽트가 발생했는지 구분하기 위해 사용하는 자료구조이다. 
- 특정 위치의 값이 1이면 해당 인터럽트가 발생했음을 의미한다.

### 인터럽트 핸들러

- 인터럽트가 발생했을 때 해당 인터럽트를 처리하는 함수이다. 
- 인터럽트 벡터에는 인터럽트 핸들러의 메모리 주소가 포인터 형태로 등록되어 있다. 
- 사용자는 시그널에 대해 자신만의 인터럽트 핸들러를 등록할 수 있다. 
- 예시: Ctrl + C를 누르면 프로세스를 종료하는 대신, 종료 여부를 물어보거나 작업 내용을 저장하도록 핸들러를 변경할 수 있다.

---

### 참고자료

[쉽게 배우는 운영체제](https://product.kyobobook.co.kr/detail/S000001743685)