# UNIX 기반 운영체제에서 파일 권한(Chmod, Chown) 관리

---

## 1. 접근 권한 변경 (chmod)

### chmod 명령어
   
- 기능: 기존 파일 또는 디렉토리에 대한 접근 권한(파일 모드)을 변경하는 명령어이다. 
- 사용 권한: 파일 모드를 변경할 수 있는 권한은 파일 소유자나 슈퍼 유저(root)만 가질 수 있다. 
- 표기 방법: 파일 모드는 기호(문자) 또는 8진수로 지정할 수 있다.

### chmod 명령 도움말
   
- 주요 옵션
  - -R: 하위 디렉토리와 파일의 권한까지 변경 (디렉토리와 파일에 동일 권한을 설정)

### 접근 권한을 기호(문자)로 표현
   
- 기호 표기법은 변경할 대상, 수행할 연산, 설정할 퍼미션으로 나뉜다. 
  - 사용자(대상): 권한을 변경할 대상을 지정 
    - u: 사용자(소유자)
    - g: 그룹 소유자 
    - o: 기타 사용자 
    - a: 모든 사용자 (기본값)
  - 수행할 명령(연산)
    - +: 권한 추가 
    - -: 권한 제거 
    - =: 권한 지정 (기존의 권한 덮어쓰기)
  - 설정할 퍼미션(접근 권한)
    - r: 읽기 
    - w: 쓰기 
    - x: 실행
  - 사용 예시
    - u+x: 소유자에게 실행 권한 추가 
    - u-x: 소유자에게 실행 권한 제거 
    - +x: 모든 사용자에게 실행 권한 추가 
    - o-rw: 기타 사용자에게 읽기, 쓰기 권한 제거 
    - go=rw: 그룹과 기타 사용자에게 읽기, 쓰기 권한 설정 (실행 권한은 제거됨)
    - u+x,go=rw: 소유자에게 실행 권한 추가하고 그룹 및 기타 사용자에게 읽기, 쓰기 권한 지정 
    - a=rw: 모든 사용자에게 읽기, 쓰기 권한 지정 
    - g-w: 그룹 소유자에게 쓰기 권한 제거 
    - g+w,o-x: 그룹 소유자에게 쓰기 권한 추가, 기타 사용자의 실행 권한 제거

### 접근 권한을 8진수로 표현
   
- 8진수 표기법을 사용하여 파일의 권한을 설정한다. 
- 3자리의 8진수를 사용하여 소유자, 그룹 소유자, 기타 사용자의 권한을 설정할 수 있다. 
- 각 권한은 읽기(r) = 4, 쓰기(w) = 2, 실행(x) = 1로 표현된다. 
- 8진수와 2진수 변환표 
  - 0: 000 → --- 
  - 1: 001 → --x 
  - 2: 010 → -w- 
  - 3: 011 → -wx 
  - 4: 100 → r-- 
  - 5: 101 → r-x 
  - 6: 110 → rw- 
  - 7: 111 → rwx

---

## 2. 소유권 또는 그룹 변경 (chown, chgrp)

### 개요
   
- 파일이나 디렉토리의 소유자(user) 또는 그룹(group) 을 변경할 때 사용한다. 
- 변경 이후, 이전 소유자는 해당 파일에 대해 이 명령을 다시 사용할 수 없다. 
- 슈퍼유저(root) 권한이 필요하다.

### 파일 소유자와 그룹 변경 (chown)

#### chown 명령어 도움말
   
- 주요 옵션 
  - -h: 심볼릭 링크 파일 자체의 소유자나 그룹을 변경한다
  - -R: 하위 디렉토리 및 하위 파일까지 소유자를 재귀적으로 변경한다

#### chown 명령어 사용 예시

```bash
chown 사용자이름 파일이름
chown 사용자이름:그룹이름 파일이름
chown -R 사용자이름 디렉토리
```

### 그룹 소유권 변경 (chgrp)
   
- 과거 UNIX 버전에서는 chown이 그룹 변경 기능이 없었기 때문에 별도로 chgrp 명령이 존재한다.

#### chgrp 명령어 도움말
   
- 주요 옵션 
  - -h: 심볼릭 링크 파일 자체의 그룹 소유권 변경 
  - -R: 하위 디렉토리 및 하위 파일까지 그룹 소유권을 재귀적으로 변경

#### chgrp 명령어 사용 예시
   
```bash
chgrp 그룹이름 파일이름
chgrp -R 그룹이름 디렉토리
```

---

## 3. 접근 권한 마스크 (umask)

### 개요

- 파일이나 디렉토리가 새로 생성될 때 기본 권한을 제한하는 리눅스 명령어.
- 기본 권한
  - 파일: 666 (rw-rw-rw-)
  - 디렉토리: 777 (rwxrwxrwx)
- umask는 뺄셈 방식으로 권한을 제한한다.

### umask 기본 동작
   
- 파일 권한 = 666 - umask 
- 디렉토리 권한 = 777 - umask 
- 예시 (umask 022)
  - 파일: 666 - 022 = 644 (rw-r--r--)
  - 디렉토리: 777 - 022 = 755 (rwxr-xr-x)

### umask 명령어 사용법
   
#### 현재 umask 값 확인

```bash
umask
```
- 출력 예시: 0022

#### umask 값 변경

```bash
umask 027
```
- 변경 후
  - 파일: 640 (rw-r-----)
  - 디렉토리: 750 (rwxr-x---)

#### umask 적용 예시
   
- 기본 umask 값 확인
```bash
umask
```
- 디렉토리 생성 후 권한 확인
```bash
mkdir testdir
ls -ld testdir
```
- 권한: drwxr-xr-x

- 파일 생성 후 권한 확인
```bash
touch testfile.txt
ls -l testfile.txt
```
- 권한: -rw-r--r--

- umask 값 변경 후 생성
```bash
umask 027
mkdir newdir
touch newfile.txt
ls -ld newdir
ls -l newfile.txt
```
- newdir: drwxr-x---, newfile.txt: -rw-r-----

### umask 영구 설정 방법
   
- 세션이 끝나면 기본값으로 돌아가기 때문에 영구 설정하려면 설정 파일에 추가해야 한다.
- 예시
```bash
echo 'umask 027' >> ~/.bashrc
```
- 시스템 전체에 적용하려면 /etc/profile 수정.

---

### 참고자료

[UNIX 기반 운영체제에서 파일 권한(Chmod, Chown) 관리](https://3dmpengines.tistory.com/1931)

[umask](https://monkeybusiness.tistory.com/671)