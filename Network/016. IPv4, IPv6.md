# IPv4 vs IPv6

---

## 1. IP

- IP(Internet Protocol)는 OSI 7계층 중 네트워크 계층(3계층)에 해당
- 네트워크 상의 논리적 주소 지정, 데이터 전달 경로 설정 등을 담당

### 주요 특성

1. 비신뢰성 (Unreliable)
    - 데이터그램이 목적지에 도달할 것이라는 보장을 하지 않음
    - 최선의 노력(Best Effort) 방식으로 동작
    - 데이터 손실, 중복, 순서 뒤바뀜 등의 가능성이 존재
    - 신뢰성은 TCP 등 상위 계층에서 제공
2. 비접속형 (Connectionless)
    - 데이터를 전송하기 전 연결을 설정하지 않음
    - 각 데이터그램은 독립적으로 처리되며, 순서 보장 없음
    - 상태 정보를 유지하지 않음 → 낮은 오버헤드, 빠른 처리
3. 주소 지정 (Addressing)
    - 각 노드(기기)는 고유의 IP 주소를 가짐
    - IP 주소는 데이터의 송수신 대상 식별에 사용됨
    - 네트워크 내의 노드를 구분하는 논리적 주소 체계
4. 경로 설정 (Routing)
    - 목적지 주소를 기반으로 데이터 전달 경로를 결정
    - 최적의 경로 선택을 통해 데이터그램 전송
    - 라우터는 이 기능을 수행하며 다양한 경로를 탐색하고 선택

### IP 전송 유형

- Unicast: 단일 호스트를 목적지로 설정하여 전송
- Multicast: 특정 그룹의 호스트들에게 전송 (Class D 사용)
- Broadcast: 동일 네트워크에 있는 모든 호스트에게 전송
    - 브로드캐스트 주소: 호스트 부분이 모두 1 (예: 192.168.1.255)

---

## 2. IP 헤더

- IP 데이터그램의 헤더는 각 필드가 특정한 역할을 가지며, 기본 크기는 옵션이 없을 경우 20바이트 
- 헤더는 빅 엔디안 방식(네트워크 바이트 순서)으로 전송되며, 이는 TCP/IP의 표준 

### 주요 필드

1. 버전 (Version)
    - 현재 사용되는 버전은 4 (IPv4)
    - IPv6는 이후 버전으로 개발됨
2. 헤더 길이 (Header Length)
    - 4비트 필드로, 헤더의 전체 길이를 4바이트 단위로 표현
    - 최소 5 (20바이트), 최대 15 (60바이트)
3. 서비스 유형 (Type of Service, TOS)
    - 3비트의 우선순위, 4비트의 TOS, 1비트 예약
    - TOS는 최소 지연, 최대 처리량, 최대 신뢰성, 최소 비용 중 하나 선택
    - 예: Telnet → 최소 지연, FTP → 최대 처리량, SNMP → 최대 신뢰성
4. 전체 길이 (Total Length)
    - IP 데이터그램 전체 크기 (헤더 + 데이터)
    - 16비트 필드로 최대 65,535 바이트
5. 식별자 (Identification)
    - 데이터그램을 고유하게 식별
    - 단편화된 조각들은 동일한 식별자 값을 가짐
6. 플래그 (Flags)
    - 3비트 구성
        - 1비트: 예약
        - 2비트: 단편화 금지 (DF)
        - 3비트: 더 많은 단편 존재 여부 (MF)
7. 단편화 옵셋 (Fragment Offset)
    - 13비트로 구성, 단편화된 조각의 상대적 위치 표시
    - 데이터그램 재조합 시 사용
8. 단편화 예시
    - 경유 네트워크의 MTU가 작을 경우 데이터그램 단편화 필요
    - DF 비트 설정 시 단편화 불가 → ICMP 에러 메시지 전송
9. 생존 시간 (Time To Live, TTL)
    - 데이터그램이 경유할 수 있는 최대 라우터 수
    - 각 라우터 통과 시 1씩 감소, 0이 되면 폐기 및 ICMP 알림
    - 무한 루프 방지 목적
10. 프로토콜 (Protocol)
    - 상위 계층의 프로토콜 종류 지정
    - TCP: 6, UDP: 17
11. 헤더 체크섬 (Header Checksum)
    - IP 헤더만을 대상으로 한 오류 검출용 필드
    - 수신 시 재계산하여 무결성 확인
    - 오류 발견 시 데이터그램 폐기 (에러 메시지 없음)
12. ARP / RARP
    - ARP (Address Resolution Protocol): IP 주소 → MAC 주소로 변환
    - RARP (Reverse ARP): MAC 주소 → IP 주소로 변환
        - 디스크 없는 시스템이 부팅 시 자신의 IP 주소를 얻는 데 사용

---

## 3. IP 주소

- IP 주소는 네트워크에 연결된 장치가 서로를 식별하고 통신할 수 있도록 고유하게 부여되는 주소
- 32비트 주소를 사람이 읽기 쉬운 형태로 나타내기 위해, 보통 8비트씩 끊어서 10진수로 표시하는 dotted decimal 형식(예: 192.168.0.1)을 사용
- IP 주소는 크게 네트워크 식별자(Netid)와 호스트 식별자(Hostid)로 구성

### IP 주소 클래스

1. Class A
    - 첫 비트: 0
    - Netid: 7비트, Hostid: 24비트
    - 약 16백만 개의 호스트 지원
    - 예: 1.0.0.0 ~ 126.255.255.255
2. Class B
    - 첫 2비트: 10
    - Netid: 14비트, Hostid: 16비트
    - 약 6만 5천 개의 호스트 지원
    - 예: 128.0.0.0 ~ 191.255.255.255
3. Class C
    - 첫 3비트: 110
    - Netid: 21비트, Hostid: 8비트
    - 254개의 호스트 지원
    - 예: 192.0.0.0 ~ 223.255.255.255
4. Class D
    - 첫 4비트: 1110
    - 멀티캐스트 주소로 사용
    - 예: 224.0.0.0 ~ 239.255.255.255
5. Class E
    - 첫 4비트: 1111
    - 실험 및 연구용으로 예약됨
    - 예: 240.0.0.0 ~ 255.255.255.255

### IP 주소 체계의 특징

- Class A: 적은 수의 대형 네트워크 (많은 호스트 수용 가능)
- Class B: 중간 규모의 네트워크
- Class C: 다수의 소규모 네트워크 (중소기업에 적합)
- Class D: 멀티캐스트를 위한 특수 용도
- Class E: 실험적 목적 (일반 네트워크에서 사용되지 않음)


### IP 주소 클래스별 범위 요약

| 클래스 | 시작 주소 범위       | 호스트 수     | 용도             |
|-----|--------------------|----------------|------------------|
| A   | 1.0.0.0 ~ 126.255.255.255 | 약 16,777,214 | 대규모 네트워크 |
| B   | 128.0.0.0 ~ 191.255.255.255| 약 65,534     | 중간 규모 네트워크 |
| C   | 192.0.0.0 ~ 223.255.255.255| 254           | 소규모 네트워크 |
| D   | 224.0.0.0 ~ 239.255.255.255| -             | 멀티캐스트      |
| E   | 127.0.0.0 ~ 127.255.255.255| -             | 루프백 테스트용 |


---

## 3. IPv4의 한계

- IPv4(Internet Protocol version 4)는 1981년 RFC 791을 통해 정의된 인터넷 주소 체계
- 32비트 주소를 사용하며, 최대 약 43억(2³² = 4,294,967,296)개의 IP 주소를 표현할 수 있음
- 그러나 인터넷의 급속한 보급, 무선 인터넷(Wi-Fi, 3G, LTE, 5G 등)과 사물인터넷(IoT)의 확산 등으로 인해 IP 주소 수요가 폭증하면서 IPv4 주소의 고갈 문제가 발생

### 주소 낭비의 원인

- IPv4는 Class A, B, C와 같이 주소를 "네트워크 단위"로 할당하는 구조이기 때문에 실제 필요보다 훨씬 많은 주소를 할당받는 일이 많음  
- 예를 들어, 약 2,000개의 주소가 필요한 기관이 B클래스 주소를 할당받으면 약 6만 개의 주소 중 대부분이 낭비되거나 예비로 남게 됨

### IPv4 주소 현황 (2012~2013년 기준)

- 총 주소 수: 4,294,967,296개
- 할당된 주소: 약 3.41억 개
- 특수 용도: 약 5.88억 개
- 미할당 주소: 약 2.96억 개
- 한국 내 할당 수: 112,231,936개
- 사용률: 99.97%

---

## 4. IPv4 vs IPv6 비교 요약

| 항목             | IPv4                        | IPv6                            |
|------------------|-----------------------------|----------------------------------|
| 주소 길이        | 32비트                      | 128비트                         |
| 주소 개수        | 약 43억                     | 약 $3.4 × 10^{38}$             |
| 주소 설정 방식   | 수동 또는 DHCP              | 자동설정 (상태/비상태형)       |
| NAT 필요 여부    | 필요                        | 불필요                          |
| 보안 기능        | 옵션 (IPSec 별도 설치)      | 기본 내장                       |
| 헤더 구조        | 복잡, 가변 길이             | 단순, 고정 길이 + 확장 가능     |
| 서비스 품질(QoS) | 제한적 지원                 | 트래픽 분류 기능 내장           |

---

### 참고자료

[컴퓨터 네트워크](https://search.shopping.naver.com/book/catalog/32497231082?query=%EC%BB%B4%ED%93%A8%ED%84%B0%20%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC&NaPm=ct%3Dm98a6sts%7Cci%3D08f5cabf98b748cd028016de25f32dbe0b5490d9%7Ctr%3Dboksl%7Csn%3D95694%7Chk%3D2df2ba9862a6f7e8dc04a8505129d21be9aac3de)