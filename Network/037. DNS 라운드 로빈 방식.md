# DNS 라운드 로빈 방식

---

## DNS 라운드 로빈 (Round Robin DNS)

### 원리

- 여러 대의 웹 서버가 각기 다른 공인 IP를 가지고 있으며, 사용자가 도메인 주소를 입력하면 DNS 서버는 IP 목록 중에서 하나 혹은 여러 개를 라운드 로빈 형태로 선택해 사용자에게 전달한다.
- 이를 통해 사용자는 여러 서버에 분산되어 접속하며, 자연스럽게 서버 부하가 분산된다.

### 동작 방식

- 사용자의 OS 애플리케이션에 따라 동작이 다르다.
    - 여러 IP 중 첫 번째 IP를 선택하거나 무작위로 선택할 수 있다.
    - IP 접속이 안 될 경우 다음 IP로 자동으로 연결될 수 있다.

### 단점

1. 서버의 수 만큼 공인 IP 주소가 필요
    - 서버 수가 늘어날 때마다 추가적인 공인 IP가 필요하다.
2. 균등한 부하 분산이 어려움
    - 프록시 서버나 DNS 캐시로 인해 동일한 서버로 반복 접속이 이루어질 수 있다.
    - TTL(Time-to-Live)을 짧게 설정해도 캐시를 해제하는 데 시간이 걸릴 수 있다.
3. 서버 다운 감지 불가
    - DNS 서버는 서버의 상태를 파악할 수 없어, 부하가 많은 서버나 다운된 서버로 연결될 위험이 있다.

### 해결 방법

1. 다중화 구성 (Synchronous Time-Division Multiplexing)
    - 각 AP 서버에 VIP(Virtual IP)를 부여하여 서버 상태를 실시간으로 확인하고, 서버 장애가 감지되면 VIP를 정상 AP 서버로 인계하는 방식이다.
    - 이를 통해 DNS 서버 테이블에 AP 서버 상태를 추가하고, 서버 상태에 따라 우회 루트나 에러 메시지를 제공할 수 있다.
2. 가중치 편성 방식 (Weighted Round Robin):
    - 각 웹 서버에 가중치를 설정하여 분산 비율을 조정합니다. 성능이 좋은 서버는 높은 가중치를 부여받아 더 자주 선택된다.
3. 로드 밸런서 도입:
    - 최소 연결 방식 (Least Connection): 가장 적은 클라이언트가 연결된 서버를 선택한다.
    - 로드 밸런서가 실시간으로 연결 수를 관리하거나, 각 서버에서 주기적으로 연결 상태를 알려준다.

---

## 기타 DNS 방식

1. 지리 기반 DNS (GeoDNS)
    - 요청자의 지리적 위치(IP 주소 기반)를 분석하여, 가장 가까운 서버의 IP를 반환한다.
    - 콘텐츠 전송 네트워크(CDN)에서 자주 사용되며, 빠른 응답 시간 제공 및 지역 트래픽 분산이 가능하다.
2. 가중치 기반 DNS (Weighted DNS)
    - 각 서버에 가중치를 부여하고, 비율에 따라 분산한다. 
    - 예를 들어, 서버 A는 70%, 서버 B는 30%로 분배될 수 있다.
    - 서버 성능 차이를 고려하여 분산할 수 있다.
3. 장애 감지 기반 DNS (Failover DNS)
    - 서버의 상태를 모니터링하고, 장애가 발생한 서버를 제외하고 나머지 서버로 트래픽을 전달한다.
    - 서버 다운을 감지하여 가용성을 높이고, 부하를 적절히 분배한다.
4. Anycast DNS
    - 여러 지역에 동일한 IP 주소를 가진 서버를 배치하여, 라우팅을 통해 요청을 가장 가까운 서버로 전달한다.
    - 빠른 응답과 DDoS 공격 방어에 효과적이며, 네트워크 레벨에서 동작한다.
5. 동적 DNS (Dynamic DNS)
    - 서버의 IP 주소가 자주 변경되는 경우 실시간으로 DNS 정보를 갱신한다.
    - 주로 개인 서버나 IoT 디바이스에서 사용되며, 동적 IP를 사용하는 환경에서 유용하다.

---

### 참고자료

[DNS 라운드 로빈](https://yaelimeee.tistory.com/46)

ChatGPT 질의 : 기타 DNS 부하 분산 방식