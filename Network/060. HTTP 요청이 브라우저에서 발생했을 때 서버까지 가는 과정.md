# HTTP 요청이 브라우저에서 발생했을 때 서버까지 가는 과정

---

## 1단계: 입력된 URL의 처리

- URL 구성 요소
  - 프로토콜: http:// 또는 https:// → 통신 규약을 정의, HTTPS는 보안 연결을 위한 SSL/TLS 사용 
  - 호스트(도메인 이름): www.naver.com → 서버의 주소를 나타냄 
  - 포트: :80, :443 → HTTP 기본 포트는 80, HTTPS 기본 포트는 443 
  - 경로: / → 요청할 자원의 경로(예: /index.html)

---

## 2단계: DNS를 통한 도메인 이름 해석

- 로컬 캐시 확인: 브라우저가 도메인 이름을 입력하면, 먼저 로컬 시스템에서 IP 주소를 캐시로 확인 
- DNS 질의 과정
  - 루트 DNS 서버: 최상위 DNS 서버로, 요청된 도메인 이름에 대한 정보를 보유한 DNS 서버로 안내 
  - TLD DNS 서버: 도메인 이름의 최상위 도메인(.com, .org 등)에 해당하는 DNS 서버로, 특정 도메인에 대한 정보를 제공 
  - Authoritative DNS 서버: 도메인에 대한 최종적인 IP 주소를 반환하는 서버 
  - IP 주소 반환: 요청된 도메인(예: www.naver.com)에 대한 IP 주소(예: 223.130.195.200)를 반환

---
## 3단계: TCP 3-Way Handshake

- SYN 패킷: 브라우저(클라이언트)가 서버에 연결을 요청하는 패킷을 전송 
  - 시퀀스 번호(seq)를 포함해 전송 
- SYN-ACK 패킷: 서버가 클라이언트의 요청을 수락하고, 시퀀스 번호와 함께 응답 
  - 서버는 자신만의 시퀀스 번호와 클라이언트 시퀀스 번호 + 1을 포함해 전송 
- ACK 패킷: 클라이언트가 서버의 응답을 확인하고 연결을 확립 
  - 서버 시퀀스 번호 + 1을 포함한 ACK 패킷을 서버로 전송
- 이 과정이 완료되면, TCP 연결이 확립되어 데이터를 주고받을 수 있게 된다.

---

## 4단계: HTTPS(SSL/TLS) 핸드셰이크

- SSL/TLS 연결 설정: HTTPS는 데이터를 암호화하기 위해 SSL/TLS 프로토콜을 사용해 안전한 연결을 설정 
- 핸드셰이크 과정
  - Client Hello: 클라이언트는 서버에 SSL/TLS 버전, 지원하는 암호화 알고리즘, 랜덤 데이터 등을 전송 
  - Server Hello: 서버는 클라이언트의 요청을 수락하고, 서버의 인증서 및 선택된 암호화 알고리즘을 전달 
  - 서버 인증서 검증: 클라이언트는 서버의 인증서를 검증하여 신뢰성을 확인 
  - Client Key Exchange: 클라이언트는 Pre-Master Secret을 생성하여 서버의 공개키로 암호화 후 전송 
  - 세션키 생성: 클라이언트와 서버는 Pre-Master Secret을 바탕으로 세션키를 생성하고 안전한 통신을 위한 암호화가 설정됨 
  - Finished 메시지: 클라이언트와 서버는 세션키를 이용해 암호화된 "Finished" 메시지를 교환하여 연결을 종료

---

## 5단계: HTTP 요청 및 응답

- HTTP Request: 브라우저는 HTTP 요청 메시지(예: GET 요청)를 서버로 전송하여 자원을 요청 
  - 예: GET /index.html HTTP/1.1
- HTTP Response: 서버는 요청에 대한 응답을 반환 
  - 상태 코드(예: 200 OK, 404 Not Found)와 함께 HTML, CSS, JavaScript, 이미지 파일 등을 반환

---

## 6단계: 브라우저의 렌더링 과정

- HTML 파싱: 브라우저는 받은 HTML을 파싱하여 DOM(Document Object Model) 트리를 생성 
- CSSOM 생성: HTML 내의 <style> 태그와 외부 CSS 파일을 파싱하여 CSSOM(CSS Object Model)을 생성 
- JavaScript 실행: JavaScript 파일을 실행하여 DOM을 조작하거나 동적 콘텐츠를 추가 
- 레이아웃 및 렌더링
  - DOM과 CSSOM을 합쳐 렌더 트리를 생성하고, 이 트리에서 각 요소의 위치, 크기 등을 계산하여 화면에 렌더링

---

## 7단계: 추가 요청 처리

- 추가 리소스 요청: 웹 페이지 로딩 중 필요한 추가 리소스(이미지, CSS 파일, JavaScript 파일 등)를 요청 
- 캐싱: 브라우저는 이전에 다운로드한 리소스를 캐시하여 성능을 최적화 
- 동일한 리소스를 다시 다운로드하지 않도록 하여 페이지 로딩 속도를 개선 

---

## 웹 페이지가 한 번에 모든 리소스를 받아오지 않는 이유

- 성능 최적화: 웹 페이지는 보통 HTML 파일을 먼저 로딩하고, HTML에서 참조하는 리소스(CSS, JavaScript, 이미지 등)를 차례대로 요청하여 페이지가 빠르게 표시될 수 있도록 함 
- 이 방식을 통해 사용자에게 빠른 피드백을 제공하고, 필요한 리소스는 배경에서 계속 로딩되도록 함

---

### 참고자료

[HTTP 요청이 브라우저에서 발생했을 때 서버까지 가는 과정](https://jsw5913.tistory.com/267)