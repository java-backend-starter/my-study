# 세션 기반 인증과 토큰 기반 인증의 차이점

---

## 1. 개요

- HTTP는 상태를 유지하지 않는 stateless한 특성을 가지고 있어, 클라이언트와 서버 간에 각 요청의 상태가 저장되지 않는다. 
- 이로 인해 웹사이트에서 인증과 인가를 관리하기 위해 추가적인 방법이 필요하다. 
- 예를 들어, 유저가 계속 로그인 상태를 유지하려면 서버는 이를 인식할 방법이 필요하다.

### 인증(Authentication)과 인가(Authorization)

- 인증(Authentication)
  - 사용자가 누구인지를 확인하는 절차이다. 
  - 예를 들어, 회원가입이나 로그인 과정이다. 
- 인가(Authorization)
  - 사용자가 특정 요청을 할 수 있는 권한이 있는지를 확인하고 허용하는 절차이다. 
  - 예를 들어, 작성한 글을 수정하거나, 본인의 아이디로 좋아요를 누르는 것과 같은 권한을 확인하는 것이다.
- 인가를 하기 위해서는 먼저 인증을 거쳐야 한다. 
- 인증을 통해 유저가 누구인지 확인한 후, 인가를 통해 해당 유저가 요청한 작업을 수행할 수 있는 권한을 부여한다.

---

## 2. 세션 기반 인증 방식

- 세션 기반 인증은 클라이언트와 서버 간에 세션을 유지하여 인증 상태를 관리하는 방식이다.

### 절차

- 유저가 로그인하면 서버는 세션 정보를 메모리 상에 저장하고, Session ID를 쿠키에 저장한다. 
- 클라이언트는 이후 모든 요청에 이 Session ID를 포함하여 서버로 전송한다. 
- 서버는 받은 Session ID를 통해 해당 사용자가 로그인 상태인지 확인하고, 인가를 수행한다.

### 장점

- 서버에서 세션을 관리하므로, 로그인 상태를 확인하기 쉽고 효율적이다. 
- 서버 메모리에 세션 정보가 저장되어 있어 관리가 용이하다.

### 단점

- 서버가 클라이언트 상태를 모두 유지해야 하므로, 많은 사용자 요청을 처리할 때 메모리나 DB에 부담이 발생할 수 있다. 
- 멀티 디바이스 환경에서 중복 로그인 문제나 관리 어려움이 생길 수 있다. 
- 로드 밸런싱을 사용할 경우, 세션 관리를 분산하는 데 어려움이 있다.

---

## 3. 토큰 기반 인증 방식 (JWT)

- 토큰 기반 인증은 서버에 사용자 정보를 저장하지 않고, 클라이언트가 받은 토큰을 이용하여 인증 상태를 확인하는 방식이다. 
- JWT(Json Web Token)를 사용하여 토큰을 발급하고, 이를 통해 인증을 처리한다.

### 절차

- 유저가 로그인하면, 서버는 Secret Key를 사용하여 유저에게 JWT 토큰을 발급한다. 
- 클라이언트는 이 토큰을 저장하고, 요청할 때마다 토큰을 서버에 전송한다.
- 서버는 토큰을 검증하여 요청이 유효한지 확인한 후 응답합니다.

### 토큰의 구성

- Header: 토큰 검증 방법에 대한 정보 (예: 서명 알고리즘)
- Payload: 사용자 정보, 유효기간, 권한 등의 데이터 
- Signature: header와 payload를 암호화한 값으로, 토큰의 변조를 방지한다.

### 장점

- 서버에 사용자 정보를 저장할 필요가 없어서 서버 부담이 줄어듭니다. 
- 멀티 디바이스 환경에서 유용하며, 클라이언트 측에서 토큰을 관리하므로 로드 밸런싱에 유리합니다.

### 단점

- 토큰은 암호화되지 않아서, payload의 데이터가 탈취될 가능성이 있다. 
  - 이를 방지하기 위해 토큰 만료 기간을 짧게 설정하거나 JWE로 암호화할 수 있다.
- Base64 인코딩된 payload를 탈취하면 데이터를 쉽게 해석할 수 있기 때문에, 중요한 정보를 포함하지 않거나 별도로 암호화해야 한다.

### Base64

- Base64는 이진 데이터를 문자로 변환하는 인코딩 방식으로, 주로 텍스트 기반의 데이터 전송에 사용된다. 
- 8비트 이진 데이터를 문자 코드가 영향을 받지 않는 ASCII 문자로 바꾸는 방식이다.

---

## 4. 비교 표

| 항목                | 세션 기반 인증 방식                          | 토큰 기반 인증 방식 (JWT)                |
|-------------------|----------------------------------------|------------------------------------|
| 인증 방식         | 서버에 세션 정보를 저장하고, 클라이언트는 Session ID를 쿠키로 저장하여 요청 시 전송 | 서버에 사용자 정보를 저장하지 않고, 클라이언트가 JWT 토큰을 저장하여 요청 시 전송 |
| 절차              | 1. 로그인 후 서버는 세션 정보를 메모리에 저장하고, Session ID를 쿠키로 저장. <br> 2. 클라이언트는 요청 시 Session ID를 전송. <br> 3. 서버는 Session ID를 통해 로그인 상태를 확인하고 인가를 수행. | 1. 로그인 후 서버는 Secret Key를 사용해 JWT 토큰을 발급. <br> 2. 클라이언트는 토큰을 저장하고 요청 시 서버에 전송. <br> 3. 서버는 토큰을 검증하여 요청을 처리. |
| 장점              | 1. 서버에서 세션 관리가 용이하고, 로그인 상태를 쉽게 확인할 수 있음. <br> 2. 서버 메모리에 세션 정보가 저장되어 관리가 효율적. | 1. 서버에 사용자 정보를 저장할 필요가 없어 서버 부담이 적음. <br> 2. 멀티 디바이스 환경에서 유용하고 로드 밸런싱에 유리함. |
| 단점              | 1. 서버가 클라이언트 상태를 유지해야 하므로, 많은 사용자 요청에 대해 메모리나 DB에 부담이 있음. <br> 2. 멀티 디바이스 환경에서 중복 로그인 문제 발생. <br> 3. 로드 밸런싱 사용 시 세션 관리가 어려움. | 1. 토큰은 암호화되지 않아서 payload가 탈취될 수 있음. <br> 2. 중요한 정보를 포함하면 위험하므로 암호화 필요. <br> 3. Base64로 인코딩된 payload는 쉽게 해석될 수 있음. |
| 세션 저장 위치     | 서버 메모리                               | 클라이언트 (JWT 토큰에 포함된 정보)        |
| 성능              | 클라이언트 수 증가 시 서버 부하 발생         | 서버 부하가 적고, 확장성 높음              |
| 보안              | 서버에서 관리하는 정보가 유출될 위험 있음    | 토큰 만료 기간 짧게 설정하여 보안 강화 가능 |
| 로드 밸런싱        | 서버에 세션 정보가 저장되어 있으므로, 세션 관리를 위한 추가 작업 필요 | 클라이언트 측에서 토큰을 관리하여 로드 밸런싱에 유리 |

### 결론 

- 이와 같이 HTTP의 stateless 특성으로 인해 인증과 인가를 관리하는 방법이 필요하며, 이를 위해 세션 기반 인증과 토큰 기반 인증 방식을 사용할 수 있다.

---

### 참고자료

[세션 기반 인증과 토큰 기반 인증의 차이점](https://velog.io/@chickenrun/%EC%84%B8%EC%85%98-%EC%9D%B8%EC%A6%9D-%EB%B0%A9%EC%8B%9D-VS-Token-%EC%9D%B8%EC%A6%9D%EB%B0%A9%EC%8B%9D%EC%9D%B8%EC%A6%9D%EA%B3%BC-%EC%9D%B8%EA%B0%80)