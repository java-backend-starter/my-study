# 싱글톤 패턴과 스프링의 싱글톤 스코프의 차이점

---

## 1. 싱글톤 패턴(Singleton Pattern)

### 정의

- 하나의 클래스에 대해 오직 하나의 인스턴스만 존재하도록 제한하는 디자인 패턴.

### 장점

- 불필요한 메모리 낭비 방지 
- 공통 객체(예: DB 연결, 로그 관리자)를 여러 곳에서 공유 가능

---

## 2. 자바에서 구현 방법

- 생성자를 private으로 선언 → 외부에서 직접 객체 생성 불가 
- static 참조 변수 선언 → 어디서든 접근 가능
- 클래스가 클래스로더에 의해 단 한 번만 로딩되면서 인스턴스화됨

### Thread Safety를 보장하는 싱글톤 구현법

#### getter 메소드에 synchronized 키워드 사용

- 문제점: 여러 스레드가 동시에 getInstance()를 호출하면 객체가 중복 생성될 수 있음
- 해결: getInstance() 메소드에 synchronized 선언
```java 
public class JavaSingleton {

    private static JavaSingleton instance;
 
    // 생성자
    private JavaSingleton(){}
     
    // thread safety getter
    public static synchronized JavaSingleton getInstance(){
        if(instance == null){
            instance = new JavaSingleton();
        }
        return instance;
    }
}
```
- 단점 
  - Locking overhead로 인한 성능 저하 
  - 인스턴스 생성 후에도 불필요한 동기화가 계속 발생

#### Double-Checked Locking

- 
```java
public static JavaSingleton getInstance() {
    if (instance == null) {
        synchronized (JavaSingleton.class) {
            if(instance == null) {
                instance = new JavaSingleton();
            }
        }
    }
    return instance;
}
```
- 동기화는 초기화 시점에만 수행 → 성능 향상

#### Bill Pugh 방식 (권장, 가장 보편적)

- 내부 static class를 활용하여 지연 초기화(lazy initialization) + Thread Safety를 동시에 보장 
- static final로 선언된 인스턴스는 단 한 번만 생성됨
```java
public class JavaSingleton {
    private JavaSingleton(){}

    private static class BillPughSingleton {
        private static final JavaSingleton instance = new JavaSingleton();
    }

    public static JavaSingleton getInstance() {
        return BillPughSingleton.instance;
    }
}
```

---

## 3. 스프링 싱글톤 패턴

### 구현 주체

- 일반 싱글톤은 클래스 자체에서 관리 
- 스프링 싱글톤은 스프링 컨테이너(Bean Factory / Application Context)가 관리

### 인스턴스 생성 및 공유

- 컨테이너 내 특정 클래스에 @Bean이 정의되면, 스프링은 단 하나의 공유 인스턴스만 생성 
- Bean 호출 시마다 항상 동일한 인스턴스를 반환

### 생성 시점

- BeanFactory: 최초 호출 시점에 생성 (Lazy Loading)
- ApplicationContext: 컨테이너 초기화 시점에 미리 생성

### 장점

- 스프링 컨테이너가 단일 인스턴스를 관리하므로 스레드 안전(Thread Safety) 자동 보장

![스프링 싱글톤 패턴](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FdrPB7A%2Fbtqyv94uGpM%2FAAAAAAAAAAAAAAAAAAAAAGcRZNT2UFoxPfOie4ufjw_dT1jv1zYcFPSeUkVkR1gZ%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DcfE9LstJKzzdKrmjB%252Fyq0tzrWic%253D)

---

### 참고자료

[싱글톤 패턴과 스프링의 싱글톤 스코프의 차이점](https://gem1n1.tistory.com/96)